<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Qu·∫£n l√Ω B·∫£ng gi√° - PhotoPro Admin</title>
  <link rel="stylesheet" href="../css/global.css">
  <link rel="stylesheet" href="../css/components.css">
  <script src="https://unpkg.com/lucide@latest"></script>
</head>
<body>
  <div class="dashboard-container">
    <!-- Sidebar -->
    <aside class="sidebar">
      <div class="sidebar-header">
        <a href="../index.html" class="sidebar-logo">
          <i data-lucide="camera"></i>
          PhotoPro Admin
        </a>
      </div>
      
      <nav class="sidebar-nav">
        <div class="nav-section">
          <div class="nav-section-title">T·ªïng quan</div>
          <a href="../index.html" class="nav-item">
            <i data-lucide="layout-dashboard"></i>
            Dashboard
          </a>
        </div>
        
        <div class="nav-section">
          <div class="nav-section-title">Qu·∫£n l√Ω</div>
          <a href="albums.html" class="nav-item">
            <i data-lucide="folder-open"></i>
            Albums
          </a>
          <a href="orders.html" class="nav-item">
            <i data-lucide="shopping-bag"></i>
            ƒê∆°n h√†ng
          </a>
          <a href="staff.html" class="nav-item" data-role="admin-system">
            <i data-lucide="users"></i>
            Nh√¢n vi√™n
          </a>
        </div>
        
        <div class="nav-section">
          <div class="nav-section-title">Kinh doanh</div>
          <a href="pricing.html" class="nav-item active" data-role="admin-system,admin-sales">
            <i data-lucide="tag"></i>
            B·∫£ng gi√°
          </a>
          <a href="revenue.html" class="nav-item">
            <i data-lucide="trending-up"></i>
            Doanh thu
          </a>
        </div>
        
        <div class="nav-section">
          <div class="nav-section-title">H·ªá th·ªëng</div>
          <a href="settings.html" class="nav-item" data-role="admin-system">
            <i data-lucide="settings"></i>
            C√†i ƒë·∫∑t
          </a>
        </div>
      </nav>
    </aside>
    
    <!-- Main Content -->
    <main class="main-content">
      <header class="dashboard-header">
        <h1 class="header-title">Qu·∫£n l√Ω B·∫£ng gi√°</h1>
      </header>
      
      <div class="content-area">
        <!-- Tabs -->
        <div class="tabs mb-4">
          <button class="tab active" onclick="switchTab('bundles')">
            <i data-lucide="package"></i>
            G√≥i Bundle
          </button>
          <button class="tab" onclick="switchTab('coupons')">
            <i data-lucide="ticket"></i>
            M√£ gi·∫£m gi√°
          </button>
        </div>
        
        <!-- Bundles Tab -->
        <div class="tab-content active" id="bundlesTab">
          <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 24px;">
            <h2 style="margin: 0; display: block;">G√≥i Bundle Pricing</h2>
            <button class="btn btn-primary" onclick="openCreateBundleModal()">
              <i data-lucide="plus"></i>
              T·∫°o g√≥i m·ªõi
            </button>
          </div>
          
          <div style="display: grid; grid-template-columns: repeat(auto-fill, minmax(280px, 1fr)); gap: 24px;">
            <!-- Bundle Card 1 -->
            <div class="card">
              <div class="card-body">
                <div style="text-align: center; padding: 24px 0;">
                  <div style="width: 64px; height: 64px; margin: 0 auto 16px; background: var(--primary-light); border-radius: 50%; display: flex; align-items: center; justify-content: center;">
                    <i data-lucide="image" style="width: 32px; height: 32px; color: var(--primary);"></i>
                  </div>
                  <h3 style="font-size: 24px; margin-bottom: 8px; display: block;">G√≥i 1 ·∫£nh</h3>
                  <div style="font-size: 32px; font-weight: 800; color: var(--primary); margin-bottom: 4px;">20,000ƒë</div>
                  <div style="font-size: 13px; color: var(--text-muted);">20,000ƒë / ·∫£nh</div>
                  
                  <div style="margin: 24px 0; padding: 16px; background: var(--surface-alt); border-radius: 8px;">
                    <div style="font-size: 13px; color: var(--text-secondary); margin-bottom: 4px;">ƒê√£ b√°n</div>
                    <div style="font-size: 20px; font-weight: 700;">150 g√≥i</div>
                  </div>
                  
                  <div style="display: flex; gap: 8px;">
                    <button class="btn btn-outline btn-sm" style="flex: 1;" onclick="editBundle(1)">
                      <i data-lucide="edit"></i>
                      S·ª≠a
                    </button>
                    <button class="btn btn-outline btn-sm" onclick="toggleFeatured(1)" title="ƒê√°nh d·∫•u ph·ªï bi·∫øn">
                      <i data-lucide="star"></i>
                    </button>
                    <button class="btn btn-danger btn-sm" onclick="deleteBundle(1)">
                      <i data-lucide="trash-2"></i>
                    </button>
                  </div>
                </div>
              </div>
            </div>
            
            <!-- Bundle Card 2 -->
            <div class="card" style="border: 2px solid var(--primary);">
              <div style="background: var(--primary); color: white; text-align: center; padding: 4px; font-size: 11px; font-weight: 700;">PH·ªî BI·∫æN NH·∫§T</div>
              <div class="card-body">
                <div style="text-align: center; padding: 24px 0;">
                  <div style="width: 64px; height: 64px; margin: 0 auto 16px; background: var(--primary-light); border-radius: 50%; display: flex; align-items: center; justify-content: center;">
                    <i data-lucide="images" style="width: 32px; height: 32px; color: var(--primary);"></i>
                  </div>
                  <h3 style="font-size: 24px; margin-bottom: 8px; display: block;">G√≥i 3 ·∫£nh</h3>
                  <div style="font-size: 32px; font-weight: 800; color: var(--primary); margin-bottom: 4px;">50,000ƒë</div>
                  <div style="font-size: 13px; color: var(--text-muted);">~16,667ƒë / ·∫£nh</div>
                  <div style="display: inline-block; margin-top: 8px; padding: 4px 12px; background: var(--success); color: white; border-radius: 12px; font-size: 12px; font-weight: 600;">Ti·∫øt ki·ªám 17%</div>
                  
                  <div style="margin: 24px 0; padding: 16px; background: var(--primary-light); border-radius: 8px;">
                    <div style="font-size: 13px; color: var(--primary-dark); margin-bottom: 4px;">ƒê√£ b√°n</div>
                    <div style="font-size: 20px; font-weight: 700; color: var(--primary);">420 g√≥i</div>
                  </div>
                  
                  <div style="display: flex; gap: 8px;">
                    <button class="btn btn-outline btn-sm" style="flex: 1;" onclick="editBundle(2)">
                      <i data-lucide="edit"></i>
                      S·ª≠a
                    </button>
                    <button class="btn btn-primary btn-sm" onclick="toggleFeatured(2)" title="B·ªè ƒë√°nh d·∫•u ph·ªï bi·∫øn">
                      <i data-lucide="star" style="fill: currentColor;"></i>
                    </button>
                    <button class="btn btn-danger btn-sm" onclick="deleteBundle(2)">
                      <i data-lucide="trash-2"></i>
                    </button>
                  </div>
                </div>
              </div>
            </div>
            
            <!-- Bundle Card 3 -->
            <div class="card">
              <div class="card-body">
                <div style="text-align: center; padding: 24px 0;">
                  <div style="width: 64px; height: 64px; margin: 0 auto 16px; background: #fef3e8; border-radius: 50%; display: flex; align-items: center; justify-content: center;">
                    <i data-lucide="folder" style="width: 32px; height: 32px; color: var(--warning);"></i>
                  </div>
                  <h3 style="font-size: 24px; margin-bottom: 8px; display: block;">G√≥i 8 ·∫£nh</h3>
                  <div style="font-size: 32px; font-weight: 800; color: var(--warning); margin-bottom: 4px;">100,000ƒë</div>
                  <div style="font-size: 13px; color: var(--text-muted);">12,500ƒë / ·∫£nh</div>
                  <div style="display: inline-block; margin-top: 8px; padding: 4px 12px; background: var(--warning); color: white; border-radius: 12px; font-size: 12px; font-weight: 600;">üî• Ti·∫øt ki·ªám 37%</div>
                  
                  <div style="margin: 24px 0; padding: 16px; background: var(--surface-alt); border-radius: 8px;">
                    <div style="font-size: 13px; color: var(--text-secondary); margin-bottom: 4px;">ƒê√£ b√°n</div>
                    <div style="font-size: 20px; font-weight: 700;">280 g√≥i</div>
                  </div>
                  
                  <div style="display: flex; gap: 8px;">
                    <button class="btn btn-outline btn-sm" style="flex: 1;" onclick="editBundle(3)">
                      <i data-lucide="edit"></i>
                      S·ª≠a
                    </button>
                    <button class="btn btn-outline btn-sm" onclick="toggleFeatured(3)" title="ƒê√°nh d·∫•u ph·ªï bi·∫øn">
                      <i data-lucide="star"></i>
                    </button>
                    <button class="btn btn-danger btn-sm" onclick="deleteBundle(3)">
                      <i data-lucide="trash-2"></i>
                    </button>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
        
        <!-- Coupons Tab -->
        <div class="tab-content" id="couponsTab">
          <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 24px;">
            <h2 style="margin: 0; display: block;">M√£ gi·∫£m gi√° (Coupon)</h2>
            <button class="btn btn-primary" onclick="openCreateCouponModal()">
              <i data-lucide="plus"></i>
              T·∫°o m√£ gi·∫£m gi√°
            </button>
          </div>
          
          <div class="card">
            <div class="table-container">
              <table>
                <thead>
                  <tr>
                    <th>M√£ coupon</th>
                    <th>Lo·∫°i gi·∫£m gi√°</th>
                    <th>Gi√° tr·ªã</th>
                    <th>S·ªë l∆∞·ª£ng</th>
                    <th>ƒê√£ d√πng</th>
                    <th>H·∫øt h·∫°n</th>
                    <th>Tr·∫°ng th√°i</th>
                    <th>Thao t√°c</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td><strong style="font-family: monospace; background: var(--primary-light); padding: 4px 8px; border-radius: 4px; color: var(--primary);">WELCOME2026</strong></td>
                    <td>Gi·∫£m %</td>
                    <td><strong>20%</strong></td>
                    <td>100</td>
                    <td>45</td>
                    <td>31/03/2026</td>
                    <td><span class="badge badge-success">ƒêang ho·∫°t ƒë·ªông</span></td>
                    <td>
                      <div style="display: flex; gap: 4px;">
                        <button class="btn btn-outline btn-sm" onclick="editCoupon(1)">
                          <i data-lucide="edit"></i>
                        </button>
                        <button class="btn btn-danger btn-sm" onclick="deleteCoupon(1)">
                          <i data-lucide="trash-2"></i>
                        </button>
                      </div>
                    </td>
                  </tr>
                  <tr>
                    <td><strong style="font-family: monospace; background: var(--primary-light); padding: 4px 8px; border-radius: 4px; color: var(--primary);">TETNGUYENDAN</strong></td>
                    <td>Gi·∫£m ti·ªÅn</td>
                    <td><strong>10,000ƒë</strong></td>
                    <td>50</td>
                    <td>12</td>
                    <td>15/02/2026</td>
                    <td><span class="badge badge-muted">H·∫øt h·∫°n</span></td>
                    <td>
                      <div style="display: flex; gap: 4px;">
                        <button class="btn btn-outline btn-sm" onclick="editCoupon(2)">
                          <i data-lucide="edit"></i>
                        </button>
                        <button class="btn btn-danger btn-sm" onclick="deleteCoupon(2)">
                          <i data-lucide="trash-2"></i>
                        </button>
                      </div>
                    </td>
                  </tr>
                  <tr>
                    <td><strong style="font-family: monospace; background: var(--primary-light); padding: 4px 8px; border-radius: 4px; color: var(--primary);">FIRSTBUY</strong></td>
                    <td>Gi·∫£m %</td>
                    <td><strong>15%</strong></td>
                    <td>Kh√¥ng gi·ªõi h·∫°n</td>
                    <td>238</td>
                    <td>-</td>
                    <td><span class="badge badge-success">ƒêang ho·∫°t ƒë·ªông</span></td>
                    <td>
                      <div style="display: flex; gap: 4px;">
                        <button class="btn btn-outline btn-sm" onclick="editCoupon(3)">
                          <i data-lucide="edit"></i>
                        </button>
                        <button class="btn btn-danger btn-sm" onclick="deleteCoupon(3)">
                          <i data-lucide="trash-2"></i>
                        </button>
                      </div>
                    </td>
                  </tr>
                </tbody>
              </table>
            </div>
          </div>
        </div>
      </div>
    </main>
  </div>
  
  <!-- Create/Edit Bundle Modal -->
  <div class="modal-overlay" id="bundleModal">
    <div class="modal">
      <div class="modal-header">
        <h3 class="modal-title">T·∫°o g√≥i bundle m·ªõi</h3>
        <button class="modal-close" onclick="closeBundleModal()">
          <i data-lucide="x" style="width: 20px; height: 20px;"></i>
        </button>
      </div>
      <div class="modal-body">
        <div class="form-group">
          <label>T√™n g√≥i *</label>
          <input type="text" placeholder="VD: G√≥i 5 ·∫£nh" id="bundleName">
        </div>
        
        <div class="form-group">
          <label>S·ªë l∆∞·ª£ng ·∫£nh *</label>
          <input type="number" placeholder="VD: 5" id="bundleQuantity" min="1">
        </div>
        
        <div class="form-group">
          <label>Gi√° g√≥i (VNƒê) *</label>
          <input type="number" placeholder="VD: 80000" id="bundlePrice" min="1000" step="1000">
        </div>
        
        <div class="form-group">
          <label style="display: flex; align-items: center; gap: 8px; cursor: pointer;">
            <input type="checkbox" id="bundleFeatured" onchange="updateFeaturedPreview()">
            <span>ƒê√°nh d·∫•u l√† g√≥i ph·ªï bi·∫øn</span>
          </label>
          <small style="color: var(--text-secondary); display: block; margin-top: 4px;">
            G√≥i ph·ªï bi·∫øn s·∫Ω ƒë∆∞·ª£c highlight v·ªõi badge "PH·ªî BI·∫æN NH·∫§T"
          </small>
        </div>
        
        <div class="alert alert-info" id="bundleCalculation" style="display: none;">
          <strong>T√≠nh to√°n:</strong>
          <div style="margin-top: 8px;">
            Gi√° / ·∫£nh: <strong id="pricePerPhoto">-</strong><br>
            So v·ªõi g√≥i 1 ·∫£nh (20,000ƒë): <strong id="savingsPercent">-</strong>
          </div>
        </div>
        
        <div class="alert alert-warning" id="featuredPreview" style="display: none; margin-top: 12px;">
          <i data-lucide="star" style="width: 16px; height: 16px; vertical-align: middle;"></i>
          <strong>G√≥i n√†y s·∫Ω ƒë∆∞·ª£c ƒë√°nh d·∫•u l√† PH·ªî BI·∫æN NH·∫§T</strong>
          <p style="margin: 4px 0 0 0; font-size: 13px;">Ch·ªâ n√™n ch·ªçn 1 g√≥i ph·ªï bi·∫øn duy nh·∫•t ƒë·ªÉ tƒÉng hi·ªáu qu·∫£ chuy·ªÉn ƒë·ªïi.</p>
        </div>
      </div>
      <div class="modal-footer">
        <button class="btn btn-outline" onclick="closeBundleModal()">H·ªßy</button>
        <button class="btn btn-primary" onclick="saveBundle()">
          <i data-lucide="save"></i>
          L∆∞u
        </button>
      </div>
    </div>
  </div>
  
  <!-- Create/Edit Coupon Modal -->
  <div class="modal-overlay" id="couponModal">
    <div class="modal">
      <div class="modal-header">
        <h3 class="modal-title">T·∫°o m√£ gi·∫£m gi√° m·ªõi</h3>
        <button class="modal-close" onclick="closeCouponModal()">
          <i data-lucide="x" style="width: 20px; height: 20px;"></i>
        </button>
      </div>
      <div class="modal-body">
        <div class="form-group">
          <label>M√£ coupon * (Ch·ªØ in hoa, kh√¥ng d·∫•u, kh√¥ng kho·∫£ng tr·∫Øng)</label>
          <input type="text" placeholder="VD: TETNGUYENDAN" id="couponCode" style="text-transform: uppercase; font-family: monospace;">
        </div>
        
        <div class="form-group">
          <label>Lo·∫°i gi·∫£m gi√° *</label>
          <select id="couponType" onchange="updateCouponType()">
            <option value="">Ch·ªçn lo·∫°i...</option>
            <option value="percent">Gi·∫£m theo %</option>
            <option value="fixed">Gi·∫£m s·ªë ti·ªÅn c·ªë ƒë·ªãnh</option>
          </select>
        </div>
        
        <div class="form-group" id="couponValueGroup" style="display: none;">
          <label id="couponValueLabel">Gi√° tr·ªã *</label>
          <input type="number" placeholder="VD: 20" id="couponValue" min="1">
        </div>
        
        <div class="form-group">
          <label>S·ªë l∆∞·ª£ng (ƒê·ªÉ tr·ªëng = kh√¥ng gi·ªõi h·∫°n)</label>
          <input type="number" placeholder="VD: 100" id="couponQuantity" min="1">
        </div>
        
        <div class="form-group">
          <label>Ng√†y h·∫øt h·∫°n (ƒê·ªÉ tr·ªëng = vƒ©nh vi·ªÖn)</label>
          <input type="date" id="couponExpiry">
        </div>
      </div>
      <div class="modal-footer">
        <button class="btn btn-outline" onclick="closeCouponModal()">H·ªßy</button>
        <button class="btn btn-primary" onclick="saveCoupon()">
          <i data-lucide="save"></i>
          L∆∞u
        </button>
      </div>
    </div>
  </div>

  <script src="../js/dashboardManager.js"></script>
  <script>
    if (typeof lucide !== 'undefined') {
      lucide.createIcons();
    }
    
    function switchTab(tabName) {
      // Remove active from all tabs and contents
      document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
      document.querySelectorAll('.tab-content').forEach(c => c.classList.remove('active'));
      
      // Add active to selected
      event.target.classList.add('active');
      document.getElementById(tabName + 'Tab').classList.add('active');
      
      lucide.createIcons();
    }
    
    // Bundle functions
    function openCreateBundleModal() {
      // Reset form
      document.getElementById('bundleName').value = '';
      document.getElementById('bundleQuantity').value = '';
      document.getElementById('bundlePrice').value = '';
      document.getElementById('bundleFeatured').checked = false;
      document.getElementById('bundleCalculation').style.display = 'none';
      document.getElementById('featuredPreview').style.display = 'none';
      document.querySelector('.modal-title').textContent = 'T·∫°o g√≥i bundle m·ªõi';
      
      document.getElementById('bundleModal').classList.add('active');
      lucide.createIcons();
    }
    
    function closeBundleModal() {
      document.getElementById('bundleModal').classList.remove('active');
    }
    
    function deleteBundle(id) {
      if (confirm('B·∫°n c√≥ ch·∫Øc mu·ªën x√≥a g√≥i n√†y?')) {
        console.log('Delete bundle:', id);
        alert('ƒê√£ x√≥a g√≥i');
      }
    }
    
    function toggleFeatured(id) {
      const currentFeatured = id === 2; // Currently bundle 2 is featured
      
      if (currentFeatured) {
        if (confirm('B·ªè ƒë√°nh d·∫•u g√≥i n√†y l√† PH·ªî BI·∫æN NH·∫§T?')) {
          console.log('Remove featured from bundle:', id);
          alert('‚ú® ƒê√£ b·ªè ƒë√°nh d·∫•u g√≥i ph·ªï bi·∫øn');
          // In real app, reload page or update UI dynamically
        }
      } else {
        if (confirm('ƒê√°nh d·∫•u g√≥i n√†y l√† PH·ªî BI·∫æN NH·∫§T?\n\n‚ö†Ô∏è G√≥i hi·ªán t·∫°i ƒëang ƒë∆∞·ª£c ƒë√°nh d·∫•u s·∫Ω b·ªã b·ªè ƒë√°nh d·∫•u.')) {
          console.log('Set featured to bundle:', id);
          alert('‚ú® ƒê√£ ƒë√°nh d·∫•u g√≥i n√†y l√† PH·ªî BI·∫æN NH·∫§T!');
          // In real app, reload page or update UI dynamically
        }
      }
    }
    
    // Real-time calculation for bundle
    document.getElementById('bundlePrice')?.addEventListener('input', updateBundleCalculation);
    document.getElementById('bundleQuantity')?.addEventListener('input', updateBundleCalculation);
    
    function updateBundleCalculation() {
      const price = parseInt(document.getElementById('bundlePrice').value) || 0;
      const quantity = parseInt(document.getElementById('bundleQuantity').value) || 0;
      
      if (price > 0 && quantity > 0) {
        const perPhoto = Math.round(price / quantity);
        const savings = Math.round((1 - perPhoto / 20000) * 100);
        
        document.getElementById('bundleCalculation').style.display = 'block';
        document.getElementById('pricePerPhoto').textContent = perPhoto.toLocaleString('vi-VN') + 'ƒë';
        document.getElementById('savingsPercent').textContent = 
          savings > 0 ? `Ti·∫øt ki·ªám ${savings}%` : 'Kh√¥ng ti·∫øt ki·ªám';
      } else {
        document.getElementById('bundleCalculation').style.display = 'none';
      }
    }
    
    // Update featured preview
    function updateFeaturedPreview() {
      const isFeatured = document.getElementById('bundleFeatured').checked;
      const preview = document.getElementById('featuredPreview');
      
      if (isFeatured) {
        preview.style.display = 'block';
      } else {
        preview.style.display = 'none';
      }
      
      lucide.createIcons();
    }
    
    function saveBundle() {
      const name = document.getElementById('bundleName').value;
      const quantity = document.getElementById('bundleQuantity').value;
      const price = document.getElementById('bundlePrice').value;
      const isFeatured = document.getElementById('bundleFeatured').checked;
      
      if (!name || !quantity || !price) {
        alert('Vui l√≤ng ƒëi·ªÅn ƒë·∫ßy ƒë·ªß th√¥ng tin');
        return;
      }
      
      console.log('Save bundle:', { name, quantity, price, isFeatured });
      
      if (isFeatured) {
        alert('‚ú® G√≥i bundle ƒë√£ ƒë∆∞·ª£c t·∫°o v√† ƒë√°nh d·∫•u l√† PH·ªî BI·∫æN NH·∫§T!');
      } else {
        alert('ƒê√£ t·∫°o g√≥i bundle th√†nh c√¥ng!');
      }
      
      closeBundleModal();
    }
    
    function editBundle(id) {
      openCreateBundleModal();
      console.log('Edit bundle:', id);
      
      // Pre-fill data for editing (demo)
      if (id === 2) {
        document.getElementById('bundleName').value = 'G√≥i 3 ·∫£nh';
        document.getElementById('bundleQuantity').value = '3';
        document.getElementById('bundlePrice').value = '50000';
        document.getElementById('bundleFeatured').checked = true;
        updateBundleCalculation();
        updateFeaturedPreview();
      }
      
      document.querySelector('.modal-title').textContent = 'Ch·ªânh s·ª≠a g√≥i bundle';
    }
    
    // Coupon functions
    function openCreateCouponModal() {
      document.getElementById('couponModal').classList.add('active');
      lucide.createIcons();
    }
    
    function closeCouponModal() {
      document.getElementById('couponModal').classList.remove('active');
    }
    
    function updateCouponType() {
      const type = document.getElementById('couponType').value;
      const valueGroup = document.getElementById('couponValueGroup');
      const valueLabel = document.getElementById('couponValueLabel');
      
      if (type === 'percent') {
        valueGroup.style.display = 'block';
        valueLabel.textContent = 'Gi√° tr·ªã (%) *';
        document.getElementById('couponValue').placeholder = 'VD: 20 (gi·∫£m 20%)';
        document.getElementById('couponValue').max = '100';
      } else if (type === 'fixed') {
        valueGroup.style.display = 'block';
        valueLabel.textContent = 'Gi√° tr·ªã (VNƒê) *';
        document.getElementById('couponValue').placeholder = 'VD: 10000 (gi·∫£m 10,000ƒë)';
        document.getElementById('couponValue').removeAttribute('max');
      } else {
        valueGroup.style.display = 'none';
      }
    }
    
    function saveCoupon() {
      const code = document.getElementById('couponCode').value.toUpperCase();
      const type = document.getElementById('couponType').value;
      const value = document.getElementById('couponValue').value;
      const quantity = document.getElementById('couponQuantity').value || 'unlimited';
      const expiry = document.getElementById('couponExpiry').value || 'permanent';
      
      if (!code || !type || !value) {
        alert('Vui l√≤ng ƒëi·ªÅn ƒë·∫ßy ƒë·ªß th√¥ng tin');
        return;
      }
      
      console.log('Save coupon:', { code, type, value, quantity, expiry });
      alert('ƒê√£ t·∫°o m√£ gi·∫£m gi√° th√†nh c√¥ng!');
      closeCouponModal();
    }
    
    function editCoupon(id) {
      openCreateCouponModal();
      console.log('Edit coupon:', id);
    }
    
    function deleteCoupon(id) {
      if (confirm('B·∫°n c√≥ ch·∫Øc mu·ªën x√≥a m√£ gi·∫£m gi√° n√†y?')) {
        console.log('Delete coupon:', id);
        alert('ƒê√£ x√≥a m√£ gi·∫£m gi√°');
      }
    }
    
    // Role-based visibility
    const currentRole = 'admin-system';
    document.querySelectorAll('[data-role]').forEach(el => {
      const allowedRoles = el.dataset.role.split(',');
      if (!allowedRoles.includes(currentRole)) {
        el.style.display = 'none';
      }
    });
  </script>
</body>
</html>
